import math
from random import randbytes

enc_greet = [
1416338717316001372875279482516678298293408949514488850525288867439165020675668641322385492892140985920707391903535099137082099113207873304473330161368973658760776746922975379656880636213796373402975540162733282451284925114682609556768175136,
679355355054330893081367509959007953747263682017341020113172985607031982520000216951519948203016469663556958649276647094809194365783482580379372014796905975826591167366287639432528990344314026255738512548015975270906621974053502114924971847,
342066212899893373708468338139235502831751005371818465886060434410733181527423585963162014418207340314461711510363477136981565593260035454007538009981263555171193916851167155059210120904162360202376323172146210239410219715010864178645741111,
389793387364232175046703647717093968322569027208483476664741102907763376479985949801485911163879708558442925725007903987966827151720177440417391423509713109452310008951387463463806500747922507449093078935252489600438554992027916600965893473
]

enc_flag = 687161424408625981724974736977603903664996048868989714468225018112922312735622387116521760667053812466109921285386371700239126426017573100113090249699724309837337651958124351738922478017804294237971839566228739568612861017432184731219479453

enc = [679355355054330893081367509959007953747263682017341020113172985607031982520000216951519948203016469663556958649276647094809194365783482580379372014796905975826591167366287639432528990344314026255738512548015975270906621974053502114924971847, 389793387364232175046703647717093968322569027208483476664741102907763376479985949801485911163879708558442925725007903987966827151720177440417391423509713109452310008951387463463806500747922507449093078935252489600438554992027916600965893473, 1416338717316001372875279482516678298293408949514488850525288867439165020675668641322385492892140985920707391903535099137082099113207873304473330161368973658760776746922975379656880636213796373402975540162733282451284925114682609556768175136, 342066212899893373708468338139235502831751005371818465886060434410733181527423585963162014418207340314461711510363477136981565593260035454007538009981263555171193916851167155059210120904162360202376323172146210239410219715010864178645741111]
e = 65537

greet = ["'sup bro", "hey", "*nods*", "hey you get my snap?"]
def b2n(b):
    return int(b.encode("utf-8").hex(),16)

# for i in greet:
#     tmp = b2n(i)
#     for k in greet:
#         tmp2 = b2n(k)
#         for j in enc:
#             for l in enc:
#                 m = math.gcd((tmp**65537)-j,(tmp2**65537)-l)
#                 if len(long_to_bytes(m)) == 100:
#                     print(m, 'heheh')
#                     break
# N = 2854190548286787206757106206670372261682376119639243915718995995962005204619774545513828147299250383352137138382527201128397010393611052007812084250724882805319115949598104388000400266372097449189842166927381448447517736501257221276569893544

def encrypt(x, key): # Encrypt is fast... no need to move my butt on CRT.
    d = 0x10001
    return pow(x, d, key)
N = 2854190548286787206757106206670372261682376119639243915718995995962005204619774545513828147299250383352137138382527201128397010393611052007812084250724882805319115949598104388000400266372097449189842166927381448447517736501257221276569893544
phi = 917511247032323457879967616938126052965422815596716508114378198819345957232912083189522592208158933511699453809265570598733276651173210786903184645001876590829619334615417795393042012806753251660625600658109504607681813767561675957113978880
def decrypt(x, d): # Encrypt is fast... no need to move my butt on CRT.
    return pow(x, d, N)
d = pow(e,-1,phi)
m = hex(decrypt(enc_flag, d))[2:]
a_string = bytes.fromhex(m)
print(a_string)
source: https://bomotodo.wordpress.com/2016/11/07/svattt-vong-loai-otp-chatbot-400-diem/?fbclid=IwAR065IduOGH88AZ0YftcvVPtILioVKC2LM8EgCWkVdxvRCtdoY0ghqRn_zM
        
